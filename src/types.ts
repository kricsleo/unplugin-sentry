import type { SentryCliCommitsOptions, SentryCliNewDeployOptions, SentryCliOptions, SentryCliUploadSourceMapsOptions } from '@sentry/cli'

/** options */
export interface Options extends SentryCliOptions {
  /**
   * The URL of the Sentry
   */
  url: string
  /**
   * Orgination name in Sentry
   */
  org: string
  /**
   * Project name in Senrty
   */
  project: string
  /**
   * Auth token
   */
  authToken: string
  /**
   * Release version,
   * auto generated by commit hash,
   * you can also config it by yourself
   */
  release?: string
  /**
   * If use short commit hash for release version
   * @default true
   */
  shortRelease?: boolean
  /**
   * If publish project,
   * means upload soucemap and record deploy info .etc.
   * You might want to turn it on when deploying but not locally developing
   * @default false
   */
  publish?: boolean
  /**
   * Sourcemap configs
   */
  sourcemap?: SourcemapOptions
  /**
   * Deploy configs
   */
  deploy?: DeployOptions
  /**
   * If delete local sourcemap after the publish,
   * @default true
   */
  cleanLocal?: boolean
  /**
   * If Remove all previous artifacts in the same release.
   * @default false
   */
  cleanArtifacts?: boolean
  /**
   * If finalize a release after the publish
   * @default true
   */
  finalize?: boolean
  /**
   * Path of config file
   */
  configFile?: string
  /**
   * Commits configs
   */
  commits?: SentryCliCommitsOptions
  /**
   * If attempts a dry run.
   * Usually used for debugging which mocks the publish work
   * @default false
   */
  dryRun?: boolean
}

export interface SourcemapOptions extends Omit<SentryCliUploadSourceMapsOptions, 'include'> {
  /**
   * Sourcemap paths
   * Auto-detect(You can provide it when it's wrong)
   */
  include?: SentryCliUploadSourceMapsOptions['include']
  /**
   * !IMPORTANT!: MUST START WITH `~/` if you don't want to set the domain
   * Auto-detect(You can provide it when it's wrong)
   */
  urlPrefix?: SentryCliUploadSourceMapsOptions['urlPrefix']
}

export interface DeployOptions extends Omit<SentryCliNewDeployOptions, 'env'> {
  /**
   * Environment
   * Auto-detect and use "process.env.NODE_ENV" as fallback
   */
  env?: SentryCliNewDeployOptions['env']
}
